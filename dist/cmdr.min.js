!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.cmdr=a()}}(function(){var a;return function b(a,c,d){function e(g,h){if(!c[g]){if(!a[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};a[g][0].call(k.exports,function(b){var c=a[g][1][b];return e(c?c:b)},k,k.exports,b,a,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(b,c,d){(function(d,e){/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/jakearchibald/es6-promise/master/LICENSE
 * @version   3.0.2
 */
(function(){"use strict";function f(a){return"function"==typeof a||"object"==typeof a&&null!==a}function g(a){return"function"==typeof a}function h(a){return"object"==typeof a&&null!==a}function i(a){U=a}function j(a){Y=a}function k(){return function(){d.nextTick(p)}}function l(){return function(){T(p)}}function m(){var a=0,b=new _(p),c=document.createTextNode("");return b.observe(c,{characterData:!0}),function(){c.data=a=++a%2}}function n(){var a=new MessageChannel;return a.port1.onmessage=p,function(){a.port2.postMessage(0)}}function o(){return function(){setTimeout(p,1)}}function p(){for(var a=0;X>a;a+=2){var b=ca[a],c=ca[a+1];b(c),ca[a]=void 0,ca[a+1]=void 0}X=0}function q(){try{var a=b,c=a("vertx");return T=c.runOnLoop||c.runOnContext,l()}catch(d){return o()}}function r(){}function s(){return new TypeError("You cannot resolve a promise with itself")}function t(){return new TypeError("A promises callback cannot return that same promise.")}function u(a){try{return a.then}catch(b){return ga.error=b,ga}}function v(a,b,c,d){try{a.call(b,c,d)}catch(e){return e}}function w(a,b,c){Y(function(a){var d=!1,e=v(c,b,function(c){d||(d=!0,b!==c?z(a,c):B(a,c))},function(b){d||(d=!0,C(a,b))},"Settle: "+(a._label||" unknown promise"));!d&&e&&(d=!0,C(a,e))},a)}function x(a,b){b._state===ea?B(a,b._result):b._state===fa?C(a,b._result):D(b,void 0,function(b){z(a,b)},function(b){C(a,b)})}function y(a,b){if(b.constructor===a.constructor)x(a,b);else{var c=u(b);c===ga?C(a,ga.error):void 0===c?B(a,b):g(c)?w(a,b,c):B(a,b)}}function z(a,b){a===b?C(a,s()):f(b)?y(a,b):B(a,b)}function A(a){a._onerror&&a._onerror(a._result),E(a)}function B(a,b){a._state===da&&(a._result=b,a._state=ea,0!==a._subscribers.length&&Y(E,a))}function C(a,b){a._state===da&&(a._state=fa,a._result=b,Y(A,a))}function D(a,b,c,d){var e=a._subscribers,f=e.length;a._onerror=null,e[f]=b,e[f+ea]=c,e[f+fa]=d,0===f&&a._state&&Y(E,a)}function E(a){var b=a._subscribers,c=a._state;if(0!==b.length){for(var d,e,f=a._result,g=0;g<b.length;g+=3)d=b[g],e=b[g+c],d?H(c,d,e,f):e(f);a._subscribers.length=0}}function F(){this.error=null}function G(a,b){try{return a(b)}catch(c){return ha.error=c,ha}}function H(a,b,c,d){var e,f,h,i,j=g(c);if(j){if(e=G(c,d),e===ha?(i=!0,f=e.error,e=null):h=!0,b===e)return void C(b,t())}else e=d,h=!0;b._state!==da||(j&&h?z(b,e):i?C(b,f):a===ea?B(b,e):a===fa&&C(b,e))}function I(a,b){try{b(function(b){z(a,b)},function(b){C(a,b)})}catch(c){C(a,c)}}function J(a,b){var c=this;c._instanceConstructor=a,c.promise=new a(r),c._validateInput(b)?(c._input=b,c.length=b.length,c._remaining=b.length,c._init(),0===c.length?B(c.promise,c._result):(c.length=c.length||0,c._enumerate(),0===c._remaining&&B(c.promise,c._result))):C(c.promise,c._validationError())}function K(a){return new ia(this,a).promise}function L(a){function b(a){z(e,a)}function c(a){C(e,a)}var d=this,e=new d(r);if(!W(a))return C(e,new TypeError("You must pass an array to race.")),e;for(var f=a.length,g=0;e._state===da&&f>g;g++)D(d.resolve(a[g]),void 0,b,c);return e}function M(a){var b=this;if(a&&"object"==typeof a&&a.constructor===b)return a;var c=new b(r);return z(c,a),c}function N(a){var b=this,c=new b(r);return C(c,a),c}function O(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function P(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function Q(a){this._id=na++,this._state=void 0,this._result=void 0,this._subscribers=[],r!==a&&(g(a)||O(),this instanceof Q||P(),I(this,a))}function R(){var a;if("undefined"!=typeof e)a=e;else if("undefined"!=typeof self)a=self;else try{a=Function("return this")()}catch(b){throw new Error("polyfill failed because global object is unavailable in this environment")}var c=a.Promise;(!c||"[object Promise]"!==Object.prototype.toString.call(c.resolve())||c.cast)&&(a.Promise=oa)}var S;S=Array.isArray?Array.isArray:function(a){return"[object Array]"===Object.prototype.toString.call(a)};var T,U,V,W=S,X=0,Y=({}.toString,function(a,b){ca[X]=a,ca[X+1]=b,X+=2,2===X&&(U?U(p):V())}),Z="undefined"!=typeof window?window:void 0,$=Z||{},_=$.MutationObserver||$.WebKitMutationObserver,aa="undefined"!=typeof d&&"[object process]"==={}.toString.call(d),ba="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,ca=new Array(1e3);V=aa?k():_?m():ba?n():void 0===Z&&"function"==typeof b?q():o();var da=void 0,ea=1,fa=2,ga=new F,ha=new F;J.prototype._validateInput=function(a){return W(a)},J.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")},J.prototype._init=function(){this._result=new Array(this.length)};var ia=J;J.prototype._enumerate=function(){for(var a=this,b=a.length,c=a.promise,d=a._input,e=0;c._state===da&&b>e;e++)a._eachEntry(d[e],e)},J.prototype._eachEntry=function(a,b){var c=this,d=c._instanceConstructor;h(a)?a.constructor===d&&a._state!==da?(a._onerror=null,c._settledAt(a._state,b,a._result)):c._willSettleAt(d.resolve(a),b):(c._remaining--,c._result[b]=a)},J.prototype._settledAt=function(a,b,c){var d=this,e=d.promise;e._state===da&&(d._remaining--,a===fa?C(e,c):d._result[b]=c),0===d._remaining&&B(e,d._result)},J.prototype._willSettleAt=function(a,b){var c=this;D(a,void 0,function(a){c._settledAt(ea,b,a)},function(a){c._settledAt(fa,b,a)})};var ja=K,ka=L,la=M,ma=N,na=0,oa=Q;Q.all=ja,Q.race=ka,Q.resolve=la,Q.reject=ma,Q._setScheduler=i,Q._setAsap=j,Q._asap=Y,Q.prototype={constructor:Q,then:function(a,b){var c=this,d=c._state;if(d===ea&&!a||d===fa&&!b)return this;var e=new this.constructor(r),f=c._result;if(d){var g=arguments[d-1];Y(function(){H(d,e,g,f)})}else D(c,e,a,b);return e},"catch":function(a){return this.then(null,a)}};var pa=R,qa={Promise:oa,polyfill:pa};"function"==typeof a&&a.amd?a(function(){return qa}):"undefined"!=typeof c&&c.exports?c.exports=qa:"undefined"!=typeof this&&(this.ES6Promise=qa),pa()}).call(this)}).call(this,b("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:2}],2:[function(a,b,c){function d(){k=!1,h.length?j=h.concat(j):l=-1,j.length&&e()}function e(){if(!k){var a=setTimeout(d);k=!0;for(var b=j.length;b;){for(h=j,j=[];++l<b;)h&&h[l].run();l=-1,b=j.length}h=null,k=!1,clearTimeout(a)}}function f(a,b){this.fun=a,this.array=b}function g(){}var h,i=b.exports={},j=[],k=!1,l=-1;i.nextTick=function(a){var b=new Array(arguments.length-1);if(arguments.length>1)for(var c=1;c<arguments.length;c++)b[c-1]=arguments[c];j.push(new f(a,b)),1!==j.length||k||setTimeout(e,0)},f.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=g,i.addListener=g,i.once=g,i.off=g,i.removeListener=g,i.removeAllListeners=g,i.emit=g,i.binding=function(a){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(a){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],3:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();Object.defineProperty(c,"__esModule",{value:!0});var f=function(){function a(b){d(this,a),this.shell=b,this.values=[],this.index=-1,this.incompleteValue=null}return e(a,[{key:"dispose",value:function(){this.values=[],this.index=-1,this.incompleteValue=null}},{key:"getNextValue",value:function(a,b){b!==this.incompleteValue&&(this.index=-1),this.incompleteValue=b;var c=this.values.filter(function(a){return a.toLowerCase().slice(0,b.toLowerCase())===b.toLowerCase()});return 0===c.length?null:(this.index>=c.length&&(this.index=-1),a&&this.index<c.length-1?this.index++:a&&this.index>=c.length-1?this.index=0:!a&&this.index>0?this.index--:!a&&this.index<=0&&(this.index=c.length-1),c[this.index])}}]),a}();c["default"]=f},{}],4:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.version=c.AutocompleteProvider=c.HistoryProvider=c.OverlayShell=c.Shell=void 0;var e=a("./shell.js");Object.defineProperty(c,"Shell",{enumerable:!0,get:function(){return e["default"]}});var f=a("./overlay-shell.js");Object.defineProperty(c,"OverlayShell",{enumerable:!0,get:function(){return f["default"]}});var g=a("./history-provider.js");Object.defineProperty(c,"HistoryProvider",{enumerable:!0,get:function(){return g["default"]}});var h=a("./autocomplete-provider.js");Object.defineProperty(c,"AutocompleteProvider",{enumerable:!0,get:function(){return h["default"]}});var i=a("es6-promise"),j=d(i);j["default"].polyfill();/*!
                                  * @overview    cmdrjs - A JavaScript based command line interface for web pages.
                                  * @copyright   Copyright (c) 2015 John Cruikshank 
                                  * @license     Licensed under MIT license
                                  * @version     1.1.0-alpha
                                 */
c.version="1.1.0-alpha"},{"./autocomplete-provider.js":3,"./history-provider.js":5,"./overlay-shell.js":6,"./shell.js":7,"es6-promise":1}],5:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();Object.defineProperty(c,"__esModule",{value:!0});var f=function(){function a(b){var c=this;d(this,a),this.shell=b,this.values=[],this.index=-1,this._preexecuteHandler=function(a){c.values.unshift(a),c.index=-1},this.shell.on("preexecute",this._preexecuteHandler)}return e(a,[{key:"dispose",value:function(){this.values=[],this.index=-1,this.shell.off("preexecute",this._preexecuteHandler)}},{key:"getNextValue",value:function(a){return a&&this.index>0?(this.index--,this.values[this.index]):!a&&this.values.length>this.index+1?(this.index++,this.values[this.index]):null}}]),a}();c["default"]=f},{}],6:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b["default"]=a,b}function f(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function g(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function h(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}var i=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),j=function r(a,b,c){null===a&&(a=Function.prototype);var d=Object.getOwnPropertyDescriptor(a,b);if(void 0===d){var e=Object.getPrototypeOf(a);return null===e?void 0:r(e,b,c)}if("value"in d)return d.value;var f=d.get;if(void 0!==f)return f.call(c)};Object.defineProperty(c,"__esModule",{value:!0});var k=a("./utils.js"),l=e(k),m=a("./shell.js"),n=d(m),o={autoOpen:!1,openKey:192,closeKey:27},p=null,q=function(a){function b(a){f(this,b);var c=null;p&&(c=p._overlayNode,p.dispose()),c||(c=l.createElement('<div style="display: none" class="cmdr-overlay"></div>'),document.body.appendChild(c)),a=l.extend({},o,a);var d=g(this,Object.getPrototypeOf(b).call(this,c,a));return d._overlayNode=c,d._documentEventHandler=null,p=d,d}return h(b,a),i(b,[{key:"init",value:function(){var a=this;this.initialized||(this._documentEventHandler=function(b){a.isOpen||-1!==["INPUT","TEXTAREA","SELECT"].indexOf(b.target.tagName)||b.target.isContentEditable||b.keyCode!=a.options.openKey?a.isOpen&&b.keyCode==a.options.closeKey&&a.close():(b.preventDefault(),a.open())},document.addEventListener("keydown",this._documentEventHandler),j(Object.getPrototypeOf(b.prototype),"init",this).call(this),this.options.autoOpen&&this.open())}},{key:"dispose",value:function(){this.initialized&&(document.removeEventListener("keydown",this._documentEventHandler),this.close(),j(Object.getPrototypeOf(b.prototype),"dispose",this).call(this))}},{key:"open",value:function(){var a=this;this._overlayNode.style.display="",setTimeout(function(){a._setPromptIndent(),a.focus()},0)}},{key:"close",value:function(){this._overlayNode.style.display="none",this.blur()}},{key:"predefine",value:function(){j(Object.getPrototypeOf(b.prototype),"predefine",this).call(this),this.define(["CLOSE","EXIT"],function(){this.shell.close()},{description:"Closes the command prompt"})}},{key:"isOpen",get:function(){return"none"!==this._overlayNode.style.display}}]),b}(n["default"]);c["default"]=q},{"./shell.js":7,"./utils.js":8}],7:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b["default"]=a,b}function f(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var g=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();Object.defineProperty(c,"__esModule",{value:!0});var h=a("./utils.js"),i=e(h),j=a("./history-provider.js"),k=d(j),l=a("./autocomplete-provider.js"),m=d(l),n={autoInit:!0,echo:!0,defaultPromptPrefix:">",template:'<div class="cmdr-shell"><div class="output"></div><div class="input"><span class="prefix"></span><div class="prompt" spellcheck="false" contenteditable="true" /></div></div>',predefinedCommands:!0,abbreviatedCommands:!0},o="undefined"!=typeof InstallTrigger,p=function(){function a(b,c){if(f(this,a),!b||!i.isElement(b))throw'"containerNode" must be an HTMLElement.';this._options=i.extend({},n,c),this._containerNode=b,this._shellNode=null,this._inputNode=null,this._prefixNode=null,this._promptNode=null,this._outputNode=null,this._outputLineNode=null,this._definitions={},this._current=null,this._queue=[],this._promptPrefix=null,this._isInputInline=!1,this._autocompleteValue=null,this._eventHandlers={},this._isInitialized=!1,this._historyProvider=null,this._autocompleteProvider=null,this._options.autoInit&&this.init()}return g(a,[{key:"init",value:function(){var a=this;this._isInitialized||(this._shellNode=i.createElement(this._options.template),this._containerNode.appendChild(this._shellNode),this._outputNode=this._shellNode.querySelector(".output"),this._inputNode=this._shellNode.querySelector(".input"),this._prefixNode=this._shellNode.querySelector(".prefix"),this._promptNode=this._shellNode.querySelector(".prompt"),this._promptNode.addEventListener("keydown",function(b){if(a._current){if(a._current.readLine&&13===b.keyCode)return a._current.readLine.resolve(a._promptNode.textContent),!1}else switch(9!==b.keyCode&&a._autocompleteReset(),b.keyCode){case 13:var c=a._promptNode.textContent;return c&&a.execute(c),b.preventDefault(),!1;case 38:return a._historyCycle(!1),b.preventDefault(),!1;case 40:return a._historyCycle(!0),b.preventDefault(),!1;case 9:return a._autocompleteCycle(!b.shiftKey),b.preventDefault(),!1}return!0}),this._promptNode.addEventListener("keypress",function(b){if(a._current&&a._current.read){if(0===b.charCode)return!1;if(a._current.read["char"]=String.fromCharCode(b.charCode),a._current.read.capture)return!1}return!0}),this._promptNode.addEventListener("keyup",function(){a._current&&a._current.read&&a._current.read["char"]&&a._current.read.resolve(a._current.read["char"])}),this._promptNode.addEventListener("paste",function(){setTimeout(function(){var b=a._promptNode.textContent,c=b.split(/\r\n|\r|\n/g),d=c.length;if(d>1){for(var e=1;d>e;e++)c[e].length>0&&a._queue.get(a).push(c[e]);a._current&&a._current.readLine?a._current.readLine.resolve(c[0]):a._current&&a._current.read?a._current.read.resolve(c[0][0]):a._current(c[0])}},0)}),o&&this._promptNode.addEventListener("input",function(){prompt.css(a._getPromptIndent())}),this._shellNode.addEventListener("click",function(b){b.target===a._inputNode||a._inputNode.contains(b.target)||b.target===a._outputNode||a._outputNode.contains(b.target)||a._promptNode.focus()}),this._options.predefinedCommands&&this.predefine(),this._historyProvider||(this._historyProvider=new k["default"](this)),this._autocompleteProvider||(this._autocompleteProvider=new m["default"](this)),this._promptPrefix=this._options.defaultPromptPrefix,this._activateInput(),this._isInitialized=!0)}},{key:"dispose",value:function(){this._isInitialized&&(this._containerNode.removeChild(this._shellNode),this._shellNode=null,this._outputNode=null,this._inputNode=null,this._prefixNode=null,this._promptNode=null,this._definitions={},this._current=null,this._queue=[],this._promptPrefix=null,this._isInputInline=!1,this._eventHandlers={},this._historyProvider&&(this._historyProvider.dispose(),this._historyProvider=null),this._autocompleteProvider&&(this._autocompleteProvider.dispose(),this._autocompleteProvider=null),this._isInitialized=!1)}},{key:"reset",value:function(){this.dispose(),this.init()}},{key:"read",value:function(a,b){var c=this;this._current&&(this._activateInput(!0),this._current.read=i.defer(),this._current.read.then(function(d){c._current.read=null,b||(c._promptNode.textContent=d),c._deactivateInput(),a(d,c._current)===!0?c.read(a,b):c._flushInput()}),this._current.read.capture=b,this._queue.length>0&&this._current.read.resolve(this._queue.shift()[0]))}},{key:"readLine",value:function(a){var b=this;this._current&&(this._activateInput(!0),this._current.readLine=i.defer(),this._current.readLine.then(function(c){b._current.readLine=null,b._promptNode.textContent=c,b._deactivateInput(),b._flushInput(),a(c,b._current)===!0&&b.readLine(a)}),this._queue.length>0&&this._current.readLine.resolve(this._queue.shift()))}},{key:"write",value:function(a,b){a=a||"";var c=i.createElement('<span class="'+b+'">'+a+"</span>");this._outputLineNode||(this._outputLineNode=i.createElement("<div></div>"),this._outputNode.appendChild(this._outputLineNode)),this._outputLineNode.appendChild(c)}},{key:"writeLine",value:function(a,b){a=(a||"")+"\n",this.write(a,b),this._outputLineNode=null}},{key:"writePad",value:function(a,b,c,d){this.write(i.pad(a,b,c),d)}},{key:"clear",value:function(){this._outputNode.innerHTML=""}},{key:"focus",value:function(){this._promptNode.focus()}},{key:"blur",value:function(){i.blur(this._promptNode)}},{key:"execute",value:function(a){var b=this;if(this._current)return void this._queue.push(a);if("string"!=typeof a||0===a.length)throw"Invalid command";this._trigger("preexecute",a),this._promptNode.textContent=a,this._flushInput(!this._options.echo),this._deactivateInput(),a=a.trim();var c=this._parseCommand(a),d=this._getDefinitions(c.name);if(!d||d.length<1)return this.writeLine("Invalid command","error"),void this._activateInput();if(d.length>1){this.writeLine("Ambiguous command","error"),this.writeLine();for(var e=0;e<d.length;e++)this.writePad(d[e].name," ",10),this.writeLine(d[e].description);return this.writeLine(),void this._activateInput()}var f=d[0];this._current={command:a,definition:f,shell:this};var g=c.args;f.parse||(g=[c.arg]),this._trigger("executing",this._current);var h=void 0;try{h=f.callback.apply(this._current,g)}catch(i){this.writeLine("Unhandled exception. See browser console log for details.","error"),console.error(i)}Promise.all([h]).then(function(){setTimeout(function(){b._trigger("execute",b._current),b._current=null,b._activateInput(),b._queue.length>0&&b.execute(b._queue.shift())},0)})}},{key:"define",value:function(a,b,c){for(var d=this._createDefinitions(a,b,c),e=0,f=d.length;f>e;e++)this._definitions[d[e].name]=d[e]}},{key:"predefine",value:function(){this.define(["HELP","?"],function(){this.shell.writeLine("The following commands are available:"),this.shell.writeLine();for(var a in this.shell.definitions){var b=this.shell.definitions[a];i.unwrap(b.available)&&(this.shell.writePad(a," ",10),this.shell.writeLine(b.description))}this.shell.writeLine()},{description:"Lists the available commands"}),this.define("ECHO",function(a){var b=a.toUpperCase();"ON"===b?this.shell.options.echo=!0:"OFF"===b?this.shell.options.echo=!1:this.shell.writeLine(a)},{parse:!1,description:"Displays provided text or toggles command echoing"}),this.define(["CLS"],function(){this.shell.clear()},{description:"Clears the command prompt"})}},{key:"on",value:function(a,b){this._eventHandlers[a]||(this._eventHandlers[a]=[]),this._eventHandlers[a].push(b)}},{key:"off",value:function(a,b){if(this._eventHandlers[a]){var c=this._eventHandlers[a].indexOf(b);c>-1&&this._eventHandlers[a].splice(c,1)}}},{key:"_trigger",value:function(a,b){if(this._eventHandlers[a]){var c=!0,d=!1,e=void 0;try{for(var f,g=this._eventHandlers[a][Symbol.iterator]();!(c=(f=g.next()).done);c=!0){var h=f.value;h.call(this,b)}}catch(i){d=!0,e=i}finally{try{!c&&g["return"]&&g["return"]()}finally{if(d)throw e}}}}},{key:"_activateInput",value:function(a){var b=this;a?(this._outputLineNode&&(this._prefixNode.textContent=this._outputLineNode.textContent,this._outputNode.removeChild(this._outputLineNode),this._outputLineNode=null),this._isInputInline=!0):(this._prefixNode.textContent=this._promptPrefix,this._isInputInline=!1),this._inputNode.style.display="",setTimeout(function(){b._promptNode.setAttribute("disabled",!1),b._setPromptIndent(),b._promptNode.focus(),i.smoothScroll(b._shellNode,b._shellNode.scrollHeight,1e3)},0)}},{key:"_deactivateInput",value:function(){this._promptNode.setAttribute("disabled",!0),this._inputNode.style.display="none"}},{key:"_flushInput",value:function(a){a||(this.write(this._prefixNode.textContent),this.writeLine(this._promptNode.textContent)),this._prefixNode.textContent="",this._promptNode.textContent=""}},{key:"_historyCycle",value:function(a){var b=this;Promise.all([this._historyProvider.getNextValue(a)]).then(function(a){var c=a[0];c&&(b._promptNode.textContent=c,i.cursorToEnd(b._promptNode),i.dispatchEvent(b._promptNode,"change",!0,!1))})}},{key:"_autocompleteCycle",value:function(a){var b=this,c=this._promptNode.textContent;c=c.replace(/\s$/," ");var d=i.getCursorPosition(this._promptNode),e=c.lastIndexOf(" ",d)+1;if(e=-1!==e?e:0,null===this._autocompleteValue){var f=c.indexOf(" ",e);f=-1!==f?f:c.length,this._autocompleteValue=c.substring(e,f)}Promise.all([this._autocompleteProvider.getNextValue(a,this._autocompleteValue)]).then(function(a){var d=a[0];d&&(b._promptNode.textContent=c.substring(0,e)+d,i.cursorToEnd(b._promptNode),i.dispatchEvent(b._promptNode,"change",!0,!1))})}},{key:"_autocompleteReset",value:function(){this._autocompleteValue=null}},{key:"_parseCommand",value:function(a){var b=/[^\s"]+|"([^"]*)"/gi,c=null,d=null,e=[],f=null;do if(f=b.exec(a),null!==f){var g=f[1]?f[1]:f[0];0===f.index?(c=g,d=a.substr(g.length+(f[1]?3:1))):e.push(g)}while(null!==f);return{name:c,arg:d,args:e}}},{key:"_createDefinitions",value:function(a,b,c){if("string"==typeof a||Array.isArray(a)||(c=b,b=a,a=null),"function"!=typeof b&&(c=b,b=null),"string"==typeof a?a=[a]:Array.isArray(a)&&(a=a.filter(function(a){return"string"==typeof a})),!Array.isArray(a)||0===a.length||"function"!=typeof b)throw"Invalid command definition";for(var d=[],e=0,f=a.length;f>e;e++){var g={name:a[e].toUpperCase(),callback:b,parse:!0,available:!0};i.extend(g,c),d.push(g)}return d}},{key:"_getDefinitions",value:function(a){a=a.toUpperCase();var b=this._definitions[a];if(b)return[b];var c=[];if(this._options.abbreviatedCommands)for(var d in this._definitions)0===d.indexOf(a,0)&&i.unwrap(this._definitions[d].available)&&c.push(this._definitions[d]);return c}},{key:"_getPrefixWidth",value:function(){var a=this._prefixNode.getBoundingClientRect().width,b=this._prefixNode.textContent,c=b.length-b.trim().length;if(!this._prefixNode._spaceWidth){var d=i.createElement('<span style="visibility: hidden">| |</span>');this._prefixNode.appendChild(d);var e=i.createElement('<span style="visibility: hidden">||</span>');this._prefixNode.appendChild(e),this._prefixNode._spaceWidth=d.offsetWidth-e.offsetWidth,this._prefixNode.removeChild(d),this._prefixNode.removeChild(e)}return a+=c*this._prefixNode._spaceWidth}},{key:"_setPromptIndent",value:function(){var a=this._getPrefixWidth()+"px";o?this._promptNode.textContent?(this._promptNode.style.textIndent=a,this._promptNode.style.paddingLeft=""):(this._promptNode.style.textIndent="",this._promptNode.style.paddingLeft=a):this._promptNode.style.textIndent=a}},{key:"isInitialized",get:function(){return this._isInitialized}},{key:"options",get:function(){return this._options}},{key:"definitions",get:function(){return this._definitions}},{key:"promptPrefix",get:function(){return this._promptPrefix},set:function(a){this._promptPrefix=a,this._isInputInline||(this._prefixNode.textContent=a,this._setPromptIndent())}},{key:"historyProvider",get:function(){return this._historyProvider},set:function(a){this._historyProvider&&this._historyProvider.dispose(),this._historyProvider=a}},{key:"autocompleteProvider",get:function(){return this._autocompleteProvider},set:function(a){this._autocompleteProvider&&this._autocompleteProvider.dispose(),this._autocompleteProvider=a}}]),a}();c["default"]=p},{"./autocomplete-provider.js":3,"./history-provider.js":5,"./utils.js":8}],8:[function(a,b,c){"use strict";function d(a){return a&&"undefined"!=typeof Symbol&&a.constructor===Symbol?"symbol":typeof a}function e(a){a=a||{};for(var b=1;b<arguments.length;b++){var c=arguments[b];if(c)for(var f in c)c.hasOwnProperty(f)&&("object"===d(c[f])?e(a[f],c[f]):a[f]=c[f])}return a}function f(a){var b=document.createElement("div");return b.innerHTML=a,b.firstChild}function g(a,b,c){var d=c>=0;for(c=Math.abs(c);a.length<c;)a=d?a+b:b+a;return a}function h(a){return"function"==typeof a?a():a}function i(a,b,c){if(b=Math.round(b),c=Math.round(c),0>c)return Promise.reject("Invalid duration");if(0===c)return a.scrollTop=b,Promise.resolve();var d=Date.now(),e=d+c,f=a.scrollTop,g=b-f,h=function(a,b,c){if(a>=c)return 0;if(c>=b)return 1;var d=(c-a)/(b-a);return d*d*(3-2*d)};return new Promise(function(b,c){var i=a.scrollTop,j=function k(){if(a.scrollTop!=i)return void c("interrupted");var j=Date.now(),l=h(d,e,j),m=Math.round(f+g*l);return a.scrollTop=m,j>=e?void b():a.scrollTop===i&&a.scrollTop!==m?void b():(i=a.scrollTop,void setTimeout(k,0))};setTimeout(j,0)})}function j(){function a(){var a=this;this.promise=new Promise(function(b,c){a.resolve=b,a.reject=c}),this.then=this.promise.then.bind(this.promise),this["catch"]=this.promise["catch"].bind(this.promise)}return new a}function k(){var a=arguments.length<=0||void 0===arguments[0]?null:arguments[0];if(!a||a===document.activeElement){var b=document.createElement("input");document.body.appendChild(b),b.focus(),document.body.removeChild(b)}}function l(a){return"object"===("undefined"==typeof HTMLElement?"undefined":d(HTMLElement))?a instanceof HTMLElement:a&&"object"===("undefined"==typeof a?"undefined":d(a))&&null!==a&&1===a.nodeType&&"string"==typeof a.nodeName}function m(a){var b=document.createRange();b.selectNodeContents(a),b.collapse(!1);var c=window.getSelection();c.removeAllRanges(),c.addRange(b)}function n(a){var b=0,c=a.ownerDocument||a.document,d=c.defaultView||c.parentWindow,e=void 0;if("undefined"!=typeof d.getSelection){if(e=d.getSelection(),e.rangeCount>0){var f=d.getSelection().getRangeAt(0),g=f.cloneRange();g.selectNodeContents(a),g.setEnd(f.endContainer,f.endOffset),b=g.toString().length}}else if((e=c.selection)&&"Control"!=e.type){var h=e.createRange(),i=c.body.createTextRange();i.moveToElementText(a),i.setEndPoint("EndToEnd",h),b=i.text.length}return b}function o(a,b,c,d){var e=document.createEvent("HTMLEvents");e.initEvent(b,c,d),a.dispatchEvent(e)}Object.defineProperty(c,"__esModule",{value:!0}),c.extend=e,c.createElement=f,c.pad=g,c.unwrap=h,c.smoothScroll=i,c.defer=j,c.blur=k,c.isElement=l,c.cursorToEnd=m,c.getCursorPosition=n,c.dispatchEvent=o},{}]},{},[4])(4)});