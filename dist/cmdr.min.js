/* cmdrjs | version 1.1.12 | license MIT | (c) 2016 John Cruikshank | https://github.com/cmdrjs/cmdrjs */
!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.cmdr=a()}}(function(){var a;return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(b,c,d){(function(e,f){!function(b,e){"object"==typeof d&&"undefined"!=typeof c?c.exports=e():"function"==typeof a&&a.amd?a(e):b.ES6Promise=e()}(this,function(){"use strict";function a(a){return"function"==typeof a||"object"==typeof a&&null!==a}function c(a){return"function"==typeof a}function d(a){X=a}function g(a){Y=a}function h(){return function(){return e.nextTick(m)}}function i(){return function(){W(m)}}function j(){var a=0,b=new _(m),c=document.createTextNode("");return b.observe(c,{characterData:!0}),function(){c.data=a=++a%2}}function k(){var a=new MessageChannel;return a.port1.onmessage=m,function(){return a.port2.postMessage(0)}}function l(){var a=setTimeout;return function(){return a(m,1)}}function m(){for(var a=0;a<V;a+=2){var b=ca[a],c=ca[a+1];b(c),ca[a]=void 0,ca[a+1]=void 0}V=0}function n(){try{var a=b,c=a("vertx");return W=c.runOnLoop||c.runOnContext,i()}catch(d){return l()}}function o(a,b){var c=arguments,d=this,e=new this.constructor(q);void 0===e[ea]&&J(e);var f=d._state;return f?!function(){var a=c[f-1];Y(function(){return G(f,e,a,d._result)})}():C(d,e,a,b),e}function p(a){var b=this;if(a&&"object"==typeof a&&a.constructor===b)return a;var c=new b(q);return y(c,a),c}function q(){}function r(){return new TypeError("You cannot resolve a promise with itself")}function s(){return new TypeError("A promises callback cannot return that same promise.")}function t(a){try{return a.then}catch(b){return ia.error=b,ia}}function u(a,b,c,d){try{a.call(b,c,d)}catch(e){return e}}function v(a,b,c){Y(function(a){var d=!1,e=u(c,b,function(c){d||(d=!0,b!==c?y(a,c):A(a,c))},function(b){d||(d=!0,B(a,b))},"Settle: "+(a._label||" unknown promise"));!d&&e&&(d=!0,B(a,e))},a)}function w(a,b){b._state===ga?A(a,b._result):b._state===ha?B(a,b._result):C(b,void 0,function(b){return y(a,b)},function(b){return B(a,b)})}function x(a,b,d){b.constructor===a.constructor&&d===o&&b.constructor.resolve===p?w(a,b):d===ia?B(a,ia.error):void 0===d?A(a,b):c(d)?v(a,b,d):A(a,b)}function y(b,c){b===c?B(b,r()):a(c)?x(b,c,t(c)):A(b,c)}function z(a){a._onerror&&a._onerror(a._result),D(a)}function A(a,b){a._state===fa&&(a._result=b,a._state=ga,0!==a._subscribers.length&&Y(D,a))}function B(a,b){a._state===fa&&(a._state=ha,a._result=b,Y(z,a))}function C(a,b,c,d){var e=a._subscribers,f=e.length;a._onerror=null,e[f]=b,e[f+ga]=c,e[f+ha]=d,0===f&&a._state&&Y(D,a)}function D(a){var b=a._subscribers,c=a._state;if(0!==b.length){for(var d=void 0,e=void 0,f=a._result,g=0;g<b.length;g+=3)d=b[g],e=b[g+c],d?G(c,d,e,f):e(f);a._subscribers.length=0}}function E(){this.error=null}function F(a,b){try{return a(b)}catch(c){return ja.error=c,ja}}function G(a,b,d,e){var f=c(d),g=void 0,h=void 0,i=void 0,j=void 0;if(f){if(g=F(d,e),g===ja?(j=!0,h=g.error,g=null):i=!0,b===g)return void B(b,s())}else g=e,i=!0;b._state!==fa||(f&&i?y(b,g):j?B(b,h):a===ga?A(b,g):a===ha&&B(b,g))}function H(a,b){try{b(function(b){y(a,b)},function(b){B(a,b)})}catch(c){B(a,c)}}function I(){return ka++}function J(a){a[ea]=ka++,a._state=void 0,a._result=void 0,a._subscribers=[]}function K(a,b){this._instanceConstructor=a,this.promise=new a(q),this.promise[ea]||J(this.promise),U(b)?(this._input=b,this.length=b.length,this._remaining=b.length,this._result=new Array(this.length),0===this.length?A(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&A(this.promise,this._result))):B(this.promise,L())}function L(){return new Error("Array Methods must be provided an Array")}function M(a){return new K(this,a).promise}function N(a){var b=this;return new b(U(a)?function(c,d){for(var e=a.length,f=0;f<e;f++)b.resolve(a[f]).then(c,d)}:function(a,b){return b(new TypeError("You must pass an array to race."))})}function O(a){var b=this,c=new b(q);return B(c,a),c}function P(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function Q(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function R(a){this[ea]=I(),this._result=this._state=void 0,this._subscribers=[],q!==a&&("function"!=typeof a&&P(),this instanceof R?H(this,a):Q())}function S(){var a=void 0;if("undefined"!=typeof f)a=f;else if("undefined"!=typeof self)a=self;else try{a=Function("return this")()}catch(b){throw new Error("polyfill failed because global object is unavailable in this environment")}var c=a.Promise;if(c){var d=null;try{d=Object.prototype.toString.call(c.resolve())}catch(b){}if("[object Promise]"===d&&!c.cast)return}a.Promise=R}var T=void 0;T=Array.isArray?Array.isArray:function(a){return"[object Array]"===Object.prototype.toString.call(a)};var U=T,V=0,W=void 0,X=void 0,Y=function(a,b){ca[V]=a,ca[V+1]=b,V+=2,2===V&&(X?X(m):da())},Z="undefined"!=typeof window?window:void 0,$=Z||{},_=$.MutationObserver||$.WebKitMutationObserver,aa="undefined"==typeof self&&"undefined"!=typeof e&&"[object process]"==={}.toString.call(e),ba="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,ca=new Array(1e3),da=void 0;da=aa?h():_?j():ba?k():void 0===Z&&"function"==typeof b?n():l();var ea=Math.random().toString(36).substring(16),fa=void 0,ga=1,ha=2,ia=new E,ja=new E,ka=0;return K.prototype._enumerate=function(){for(var a=this.length,b=this._input,c=0;this._state===fa&&c<a;c++)this._eachEntry(b[c],c)},K.prototype._eachEntry=function(a,b){var c=this._instanceConstructor,d=c.resolve;if(d===p){var e=t(a);if(e===o&&a._state!==fa)this._settledAt(a._state,b,a._result);else if("function"!=typeof e)this._remaining--,this._result[b]=a;else if(c===R){var f=new c(q);x(f,a,e),this._willSettleAt(f,b)}else this._willSettleAt(new c(function(b){return b(a)}),b)}else this._willSettleAt(d(a),b)},K.prototype._settledAt=function(a,b,c){var d=this.promise;d._state===fa&&(this._remaining--,a===ha?B(d,c):this._result[b]=c),0===this._remaining&&A(d,this._result)},K.prototype._willSettleAt=function(a,b){var c=this;C(a,void 0,function(a){return c._settledAt(ga,b,a)},function(a){return c._settledAt(ha,b,a)})},R.all=M,R.race=N,R.resolve=p,R.reject=O,R._setScheduler=d,R._setAsap=g,R._asap=Y,R.prototype={constructor:R,then:o,catch:function(a){return this.then(null,a)}},S(),R.polyfill=S,R.Promise=R,R})}).call(this,b("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:2}],2:[function(a,b,c){function d(){throw new Error("setTimeout has not been defined")}function e(){throw new Error("clearTimeout has not been defined")}function f(a){if(l===setTimeout)return setTimeout(a,0);if((l===d||!l)&&setTimeout)return l=setTimeout,setTimeout(a,0);try{return l(a,0)}catch(b){try{return l.call(null,a,0)}catch(b){return l.call(this,a,0)}}}function g(a){if(m===clearTimeout)return clearTimeout(a);if((m===e||!m)&&clearTimeout)return m=clearTimeout,clearTimeout(a);try{return m(a)}catch(b){try{return m.call(null,a)}catch(b){return m.call(this,a)}}}function h(){q&&o&&(q=!1,o.length?p=o.concat(p):r=-1,p.length&&i())}function i(){if(!q){var a=f(h);q=!0;for(var b=p.length;b;){for(o=p,p=[];++r<b;)o&&o[r].run();r=-1,b=p.length}o=null,q=!1,g(a)}}function j(a,b){this.fun=a,this.array=b}function k(){}var l,m,n=b.exports={};!function(){try{l="function"==typeof setTimeout?setTimeout:d}catch(a){l=d}try{m="function"==typeof clearTimeout?clearTimeout:e}catch(a){m=e}}();var o,p=[],q=!1,r=-1;n.nextTick=function(a){var b=new Array(arguments.length-1);if(arguments.length>1)for(var c=1;c<arguments.length;c++)b[c-1]=arguments[c];p.push(new j(a,b)),1!==p.length||q||f(i)},j.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=k,n.addListener=k,n.once=k,n.off=k,n.removeListener=k,n.removeAllListeners=k,n.emit=k,n.binding=function(a){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(a){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},{}],3:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=function(){function a(){d(this,a),this.lookups=[],this._context=null,this._index=-1,this._values=[],this._predefineLookups()}return e(a,[{key:"activate",value:function(a){}},{key:"deactivate",value:function(a){}},{key:"getNextValue",value:function(a,b){var c=this;return b!==this._context&&(this._context=b,this._index=-1,this._values=this._lookupValues(b)),Promise.all([this._values]).then(function(d){d=d[0];var e=d.filter(function(a){return""===b.incompleteValue||a.toLowerCase().slice(0,b.incompleteValue.toLowerCase().length)===b.incompleteValue.toLowerCase()});return 0===e.length?null:(c._index>=e.length&&(c._index=-1),a&&c._index<e.length-1?c._index++:a&&c._index>=e.length-1?c._index=0:!a&&c._index>0?c._index--:!a&&c._index<=0&&(c._index=e.length-1),e[c._index])})}},{key:"_lookupValues",value:function(a){function b(b){return Array.isArray(b)?b:"function"==typeof b?b(a):null}var c=!0,d=!1,e=void 0;try{for(var f,g=this.lookups[Symbol.iterator]();!(c=(f=g.next()).done);c=!0){var h=f.value,i=b(h);if(i)return i}}catch(j){d=!0,e=j}finally{try{!c&&g.return&&g.return()}finally{if(d)throw e}}return[]}},{key:"_predefineLookups",value:function(){function a(a){return""!==a.precursorValue.trim()?null:Object.keys(a.shell.definitionProvider.definitions)}this.lookups.push(a)}}]),a}();c.default=f},{}],4:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=function(){function a(){d(this,a),this._isCancelRequested=!1,this._cancelHandlers=[]}return e(a,[{key:"cancel",value:function(){if(!this._isCancelRequested){var a=!0,b=!1,c=void 0;try{for(var d,e=this._cancelHandlers[Symbol.iterator]();!(a=(d=e.next()).done);a=!0){var f=d.value;try{f(this)}catch(g){console.error(g)}}}catch(h){b=!0,c=h}finally{try{!a&&e.return&&e.return()}finally{if(b)throw c}}}this._isCancelRequested=!0}},{key:"uncancel",value:function(){this._isCancelRequested=!1}},{key:"onCancel",value:function(a){if(this._isCancelRequested)try{a(this)}catch(b){console.error(b)}this._cancelHandlers.push(a)}},{key:"offCancel",value:function(a){var b=this._cancelHandlers.indexOf(a);b>-1&&this._cancelHandlers.splice(b,1)}},{key:"isCancelRequested",get:function(){return this._isCancelRequested}}]),a}();c.default=f},{}],5:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.version=c.Plugin=c.Definition=c.DefinitionProvider=c.AutocompleteProvider=c.HistoryProvider=c.CommandParser=c.CommandHandler=c.OverlayShell=c.Shell=void 0;var e=a("./shell.js");Object.defineProperty(c,"Shell",{enumerable:!0,get:function(){return d(e).default}});var f=a("./overlay-shell.js");Object.defineProperty(c,"OverlayShell",{enumerable:!0,get:function(){return d(f).default}});var g=a("./command-handler.js");Object.defineProperty(c,"CommandHandler",{enumerable:!0,get:function(){return d(g).default}});var h=a("./command-parser.js");Object.defineProperty(c,"CommandParser",{enumerable:!0,get:function(){return d(h).default}});var i=a("./history-provider.js");Object.defineProperty(c,"HistoryProvider",{enumerable:!0,get:function(){return d(i).default}});var j=a("./autocomplete-provider.js");Object.defineProperty(c,"AutocompleteProvider",{enumerable:!0,get:function(){return d(j).default}});var k=a("./definition-provider.js");Object.defineProperty(c,"DefinitionProvider",{enumerable:!0,get:function(){return d(k).default}});var l=a("./definition.js");Object.defineProperty(c,"Definition",{enumerable:!0,get:function(){return d(l).default}});var m=a("./plugin.js");Object.defineProperty(c,"Plugin",{enumerable:!0,get:function(){return d(m).default}});var n=a("es6-promise"),o=d(n);o.default.polyfill();c.version="1.1.12"},{"./autocomplete-provider.js":3,"./command-handler.js":6,"./command-parser.js":7,"./definition-provider.js":8,"./definition.js":9,"./history-provider.js":10,"./overlay-shell.js":11,"./plugin.js":12,"./shell.js":13,"es6-promise":1}],6:[function(a,b,c){"use strict";function d(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b.default=a,b}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var f=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=a("./utils.js"),h=d(g),i={contextExtensions:{}},j=function(){function a(b){e(this,a),this.options=h.extend({},i,b)}return f(a,[{key:"executeCommand",value:function(a,b,c){var d=a.commandParser.parseCommand(b),e=a.definitionProvider.getDefinitions(d.name);if(!e||e.length<1)return a.writeLine("Invalid command","error"),!1;if(e.length>1){a.writeLine("Ambiguous command","error"),a.writeLine();for(var f=0;f<e.length;f++)a.writePad(e[f].name,10),a.writeLine(e[f].description);return a.writeLine(),!1}var g=e[0],i={shell:a,command:b,definition:g,parsed:d,defer:h.defer,cancelToken:c};h.extend(i,this.options.contextExtensions);var j=d.args;if(g.help&&j.length>0&&"/?"===j[j.length-1]){if("string"==typeof g.help)return a.writeLine(g.help),!1;if("function"==typeof g.help)return g.help.apply(i,j)}return g.main.apply(i,j)}}]),a}();c.default=j},{"./utils.js":14}],7:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=function(){function a(){d(this,a)}return e(a,[{key:"parseCommand",value:function(a){var b=/[^\s"]+|"([^"]*)"/gi,c=null,d=null,e=[],f=null;do if(f=b.exec(a),null!==f){var g=f[1]?f[1]:f[0];0===f.index?(c=g,d=a.substr(g.length+(f[1]?3:1))):e.push(g)}while(null!==f);return{name:c,argString:d,args:e}}}]),a}();c.default=f},{}],8:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b.default=a,b}function f(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var g=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),h=a("./utils.js"),i=e(h),j=a("./definition.js"),k=d(j),l={predefined:["HELP","ECHO","CLS"],allowAbbreviations:!0},m=function(){function a(b){var c=this;f(this,a),this.options=i.extend({},l,b),this.definitions={},this.define=function(){for(var a=arguments.length,b=Array(a),d=0;d<a;d++)b[d]=arguments[d];c.addDefinition(new(Function.prototype.bind.apply(k.default,[null].concat(b))))},this._predefine()}return g(a,[{key:"activate",value:function(a){"undefined"==typeof a.define&&(a.define=this.define)}},{key:"deactivate",value:function(a){a.define===this.define&&delete a.define}},{key:"getDefinitions",value:function(a){a=a.toUpperCase();var b=this.definitions[a];if(b)return b.available?[b]:null;var c=[];if(this.options.allowAbbreviations)for(var d in this.definitions)0===d.indexOf(a,0)&&i.unwrap(this.definitions[d].available)&&c.push(this.definitions[d]);return c}},{key:"addDefinition",value:function(a){this.definitions[a.name]=a}},{key:"_predefine",value:function(){var a=this;this.options.predefined.indexOf("HELP")>-1&&this.define({name:"HELP",main:function(){this.shell.writeLine("The following commands are available:"),this.shell.writeLine();var b=Object.keys(a.definitions).map(function(b){return a.definitions[b]}).filter(function(a){return a.available}),c=b.slice().sort(function(a,b){return b.name.length-a.name.length})[0].name.length;this.shell.writeTable(b,["name:"+(c+2).toString(),"description:40"]),this.shell.writeLine(),this.shell.writeLine('* Pass "/?" into any command to display help for that command.'),a.options.allowAbbreviations&&this.shell.writeLine('* Command abbreviations are allowed (e.g. "H" for "HELP").')},description:"Lists the available commands."}),this.options.predefined.indexOf("ECHO")>-1&&this.define({name:"ECHO",main:function(){var a=this.argString.toUpperCase();"ON"===a?this.shell.echo=!0:"OFF"===a?this.shell.echo=!1:this.argString?this.shell.writeLine(this.argString):this.shell.writeLine("ECHO is "+(this.shell.echo?"on.":"off."))},description:"Displays messages, or toggles command echoing.",usage:"ECHO [ON | OFF]\nECHO [message]\n\nType ECHO without parameters to display the current echo setting."}),this.options.predefined.indexOf("CLS")>-1&&this.define({name:"CLS",main:function(){this.shell.clear()},description:"Clears the command prompt."})}}]),a}();c.default=m},{"./definition.js":9,"./utils.js":14}],9:[function(a,b,c){"use strict";function d(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b.default=a,b}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var f=a("./utils.js"),g=d(f),h=function a(b,c,d){if(e(this,a),"string"!=typeof b&&(d=c,c=b,b=null),"function"!=typeof c&&(d=c,c=null),this.name=b,this.main=c,this.description=null,this.usage=null,this.available=!0,this.help=function(){this.definition.description&&this.shell.writeLine(this.definition.description),this.definition.description&&this.definition.usage&&this.shell.writeLine(),this.definition.usage&&this.shell.writeLine(this.definition.usage)},g.extend(this,d),"string"!=typeof this.name)throw'"name" must be a string.';if("function"!=typeof this.main)throw'"main" must be a function.';this.name=this.name.toUpperCase(),this.usage||(this.usage=this.name)};c.default=h},{"./utils.js":14}],10:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=function(){function a(){var b=this;d(this,a),this.values=[],this.index=-1,this._preexecuteHandler=function(a){b.values.unshift(a),b.index=-1}}return e(a,[{key:"activate",value:function(a){a.on("preexecute",this._preexecuteHandler)}},{key:"deactivate",value:function(a){a.off("preexecute",this._preexecuteHandler)}},{key:"getNextValue",value:function(a){return a&&this.index>0?(this.index--,this.values[this.index]):!a&&this.values.length>this.index+1?(this.index++,this.values[this.index]):null}}]),a}();c.default=f},{}],11:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b.default=a,b}function f(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function g(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function h(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}Object.defineProperty(c,"__esModule",{value:!0});var i=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),j=function a(b,c,d){null===b&&(b=Function.prototype);var e=Object.getOwnPropertyDescriptor(b,c);if(void 0===e){var f=Object.getPrototypeOf(b);return null===f?void 0:a(f,c,d)}if("value"in e)return e.value;var g=e.get;if(void 0!==g)return g.call(d)},k=a("./utils.js"),l=e(k),m=a("./shell.js"),n=d(m),o={autoOpen:!1,openKey:192,closeKey:27},p=function(a){function b(a){f(this,b);var c=l.createElement('<div style="display: none" class="cmdr-overlay"></div>');document.body.appendChild(c),a=l.extend({},o,a);var d=g(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,c,a));return d._overlayNode=c,d._documentEventHandler=null,d}return h(b,a),i(b,[{key:"init",value:function(){var a=this;this.initialized||(this._documentEventHandler=function(b){a.isOpen||["INPUT","TEXTAREA","SELECT"].indexOf(b.target.tagName)!==-1||b.target.isContentEditable||b.keyCode!=a.options.openKey?a.isOpen&&b.keyCode==a.options.closeKey&&a.close():(b.preventDefault(),a.open())},document.addEventListener("keydown",this._documentEventHandler),j(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"init",this).call(this),this.options.autoOpen&&this.open())}},{key:"dispose",value:function(){this.initialized&&(j(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"dispose",this).call(this),document.removeEventListener("keydown",this._documentEventHandler),document.body.removeChild(this._overlayNode))}},{key:"open",value:function(){var a=this;this._overlayNode.style.display="",document.body.style.overflow="hidden",setTimeout(function(){a._fixPromptIndent(),a.focus()},0)}},{key:"close",value:function(){this._overlayNode.style.display="none",document.body.style.overflow="",this.blur()}},{key:"isOpen",get:function(){return"none"!==this._overlayNode.style.display}}]),b}(n.default);c.default=p},{"./shell.js":13,"./utils.js":14}],12:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=function(){function a(){d(this,a)}return e(a,[{key:"activate",value:function(a){}},{key:"deactivate",value:function(a){}}]),a}();c.default=f},{}],13:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b.default=a,b}function f(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},h=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),i=a("./utils.js"),j=e(i),k=a("./history-provider.js"),l=d(k),m=a("./autocomplete-provider.js"),n=d(m),o=a("./definition-provider.js"),p=d(o),q=a("./command-handler.js"),r=d(q),s=a("./command-parser.js"),t=d(s),u=a("./cancel-token.js"),v=d(u),w={echo:!0,promptPrefix:">",template:'<div class="cmdr-shell"><div class="output"></div><div class="input"><span class="prefix"></span><div class="prompt" spellcheck="false" contenteditable="true" /></div></div>',theme:"cmd",definitionProvider:null,historyProvider:null,autocompleteProvider:null,commandHandler:null,commandParser:null,plugins:[]},x=function(){function a(b,c){if(f(this,a),!b||!j.isElement(b))throw'"containerNode" must be an HTMLElement.';this._options=j.extend({},w,c),this._containerNode=b,this._shellNode=null,this._inputNode=null,this._prefixNode=null,this._promptNode=null,this._outputNode=null,this._outputLineNode=null,this._echo=!0,this._current=null,this._queue=[],this._promptPrefix=null,this._isInputInline=!1,this._autocompleteContext=null,this._eventHandlers={},this._isInitialized=!1,this._historyProvider=null,this._autocompleteProvider=null,this._definitionProvider=null,this._commandHandler=null,this._commandParser=null,this._plugins=[],this.init()}return h(a,[{key:"init",value:function(){var a=this;if(!this._isInitialized){this._shellNode=j.createElement(this._options.template),this._shellNode.className+=" cmdr-shell--"+this._options.theme,this._containerNode.appendChild(this._shellNode),this._outputNode=this._shellNode.querySelector(".output"),this._inputNode=this._shellNode.querySelector(".input"),this._prefixNode=this._shellNode.querySelector(".prefix"),this._promptNode=this._shellNode.querySelector(".prompt"),this._promptNode.addEventListener("keydown",function(b){if(a._current){if(b.ctrlKey&&67===b.keyCode?a.cancel():a._current.readLine&&13===b.keyCode&&a._current.readLine.resolve(a._promptNode.textContent),!a._current.read&&!a._current.readLine)return b.preventDefault(),!1}else switch(9===b.keyCode||b.shiftKey||a._autocompleteReset(),b.keyCode){case 13:var c=a._promptNode.textContent;return c&&a.execute(c),b.preventDefault(),!1;case 38:return a._historyCycle(!1),b.preventDefault(),!1;case 40:return a._historyCycle(!0),b.preventDefault(),!1;case 9:return a._autocompleteCycle(!b.shiftKey),b.preventDefault(),!1}return!0}),this._promptNode.addEventListener("keypress",function(b){return!a._current||!a._current.read||(0!==b.charCode&&a._current.read.resolve(String.fromCharCode(b.charCode)),b.preventDefault(),!1)}),this._shellNode.addEventListener("click",function(b){b.target===a._inputNode||a._inputNode.contains(b.target)||b.target===a._outputNode||a._outputNode.contains(b.target)||a._promptNode.focus()}),this._promptPrefix=this._options.promptPrefix,this._echo=this._options.echo,this._commandHandler=this.options.commandHandler||new r.default,this._commandParser=this.options.commandParser||new t.default,this._definitionProvider=this._options.definitionProvider||new p.default,this._definitionProvider.activate(this),this._historyProvider=this._options.historyProvider||new l.default,this._historyProvider.activate(this),this._autocompleteProvider=this._options.autocompleteProvider||new n.default,this._autocompleteProvider.activate(this);var b=!0,c=!1,d=void 0;try{for(var e,f=this._options.plugins[Symbol.iterator]();!(b=(e=f.next()).done);b=!0){var g=e.value;this._plugins.push(g),g.activate(this)}}catch(h){c=!0,d=h}finally{try{!b&&f.return&&f.return()}finally{if(c)throw d}}this._activateInput(),this._isInitialized=!0}}},{key:"dispose",value:function(){if(this._isInitialized){this._containerNode.removeChild(this._shellNode),this._shellNode=null,this._outputNode=null,this._inputNode=null,this._prefixNode=null,this._promptNode=null,this._echo=!0,this._current=null,this._queue=[],this._promptPrefix=null,this._isInputInline=!1,this._autocompleteContext=null,this._eventHandlers={},this._commandHandler=null,this._commandParser=null,this._historyProvider&&(this._historyProvider.deactivate(this),this._historyProvider=null),this._autocompleteProvider&&(this._autocompleteProvider.deactivate(this),this._autocompleteProvider=null),this._definitionProvider&&(this._definitionProvider.deactivate(this),this._definitionProvider=null);var a=!0,b=!1,c=void 0;try{for(var d,e=this._plugins[Symbol.iterator]();!(a=(d=e.next()).done);a=!0){var f=d.value;f.deactivate(this)}}catch(g){b=!0,c=g}finally{try{!a&&e.return&&e.return()}finally{if(b)throw c}}this._plugins=[],this._isInitialized=!1}}},{key:"reset",value:function(){this.dispose(),this.init()}},{key:"read",value:function(a,b){var c=this;if(this._current){this._activateInput(!0);var d=j.defer();return this._current.read=j.defer(),this._current.read.then(function(e){c._current.read=null,c._deactivateInput(),b||(c._prefixNode.textContent+=e,c._promptNode.textContent="");var f=!1;try{f=a(e,c._current)}catch(g){c.writeLine("Unhandled exception","error"),c.writeLine(g,"error"),d.reject(g)}f===!0?c.read(a).then(d.resolve,d.reject):(c._flushInput(),d.resolve()),d.resolve()}),this._current.read.intercept=b,d}}},{key:"readLine",value:function(a){var b=this;if(this._current){this._activateInput(!0);var c=j.defer();return this._current.readLine=j.defer(),this._current.readLine.then(function(d){b._current.readLine=null,b._promptNode.textContent=d,b._deactivateInput(),b._flushInput();var e=!1;try{e=a(d,b._current)}catch(f){b.writeLine("Unhandled exception","error"),b.writeLine(f,"error"),c.reject(f)}e===!0?b.readLine(a).then(c.resolve,c.reject):c.resolve()}),c}}},{key:"write",value:function(a,b){a=j.encodeHtml(a||"");var c=j.createElement("<span>"+a+"</span>");b&&(c.className=b),this._outputLineNode||(this._outputLineNode=j.createElement("<div></div>"),this._outputNode.appendChild(this._outputLineNode)),this._outputLineNode.appendChild(c)}},{key:"writeLine",value:function(a,b){a=(a||"")+"\n",this.write(a,b),this._outputLineNode=null}},{key:"writePad",value:function(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:" ",d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.write(j.pad(a,b,c),d)}},{key:"writeTable",value:function(a,b,c,d){var e=this;b=b.map(function(a){var b=a.split(":");return{name:b[0],padding:b.length>1?b[1]:10,header:b.length>2?b[2]:b[0]}});var f=function(a,b){a=a||"","*"===b?e.write(a,d):e.writePad(a,parseInt(b,10)," ",d)};if(c){var g=!0,h=!1,i=void 0;try{for(var j,k=b[Symbol.iterator]();!(g=(j=k.next()).done);g=!0){var l=j.value;f(l.header,l.padding)}}catch(m){h=!0,i=m}finally{try{!g&&k.return&&k.return()}finally{if(h)throw i}}this.writeLine();var n=!0,o=!1,p=void 0;try{for(var q,r=b[Symbol.iterator]();!(n=(q=r.next()).done);n=!0){var s=q.value;f(Array(s.header.length+1).join("-"),s.padding)}}catch(m){o=!0,p=m}finally{try{!n&&r.return&&r.return()}finally{if(o)throw p}}this.writeLine()}var t=!0,u=!1,v=void 0;try{for(var w,x=a[Symbol.iterator]();!(t=(w=x.next()).done);t=!0){var y=w.value,z=!0,A=!1,B=void 0;try{for(var C,D=b[Symbol.iterator]();!(z=(C=D.next()).done);z=!0){var E=C.value;
f(y[E.name]?y[E.name].toString():"",E.padding)}}catch(m){A=!0,B=m}finally{try{!z&&D.return&&D.return()}finally{if(A)throw B}}this.writeLine()}}catch(m){u=!0,v=m}finally{try{!t&&x.return&&x.return()}finally{if(u)throw v}}}},{key:"clear",value:function(){this._outputNode.innerHTML=""}},{key:"focus",value:function(){this._promptNode.focus()}},{key:"blur",value:function(){j.blur(this._promptNode)}},{key:"on",value:function(a,b){this._eventHandlers[a]||(this._eventHandlers[a]=[]),this._eventHandlers[a].push(b)}},{key:"off",value:function(a,b){if(this._eventHandlers[a]){var c=this._eventHandlers[a].indexOf(b);c>-1&&this._eventHandlers[a].splice(c,1)}}},{key:"execute",value:function(a){var b=this,c=void 0;if("object"===("undefined"==typeof a?"undefined":g(a)))c=a.deferred,a=a.text;else{if(!("string"==typeof a&&a.length>0))return c=j.defer(),c.reject("Invalid command"),c;c=j.defer();for(var d=arguments.length,e=Array(d>1?d-1:0),f=1;f<d;f++)e[f-1]=arguments[f];e&&(a=this._buildCommand(a,e))}if(this._current)return this._queue.push({deferred:c,text:a,executeOnly:!0}),c;var h=a;a=a.trim(),this._trigger("preexecute",a),this._promptNode.textContent=h,this._flushInput(!this._echo),this._deactivateInput();var i=new v.default;this._current={command:a,cancelToken:i};var k=function(){setTimeout(function(){b._current=null,b._outputNode.children.length>0&&b.writeLine(),b._activateInput(),b._queue.length>0&&b.execute(b._queue.shift())},0)},l=void 0;try{l=this._commandHandler.executeCommand(this,a,i)}catch(m){return this.writeLine("Unhandled exception","error"),this.writeLine(m,"error"),c.reject("Unhandled exception"),k(),c}return Promise.all([l]).then(function(d){b._trigger("execute",{command:a});try{c.resolve(d[0])}finally{k()}},function(d){b._trigger("execute",{command:a,error:d});try{c.reject(d)}finally{k()}}),c}},{key:"cancel",value:function(){this._current&&this._current.cancelToken.cancel()}},{key:"_buildCommand",value:function(a,b){var c=!0,d=!1,e=void 0;try{for(var f,g=b[Symbol.iterator]();!(c=(f=g.next()).done);c=!0){var h=f.value;a+="string"==typeof h&&h.indexOf(" ")>-1?' "'+h+'"':" "+h.toString()}}catch(i){d=!0,e=i}finally{try{!c&&g.return&&g.return()}finally{if(d)throw e}}return a}},{key:"_activateInput",value:function(a){a?(this._outputLineNode&&(this._prefixNode.innerHTML=this._outputLineNode.innerHTML,this._outputNode.removeChild(this._outputLineNode),this._outputLineNode=null),this._isInputInline=!0):(this._prefixNode.innerHTML=this._promptPrefix,this._isInputInline=!1),this._inputNode.style.display="",this._promptNode.removeAttribute("disabled"),this._fixPromptIndent(),this._promptNode.focus(),this._shellNode.scrollTop=this._shellNode.scrollHeight}},{key:"_deactivateInput",value:function(){this._promptNode.style.textIndent="",this._promptNode.setAttribute("disabled","disabled")}},{key:"_flushInput",value:function(a){if(!a){var b=""+this._prefixNode.innerHTML+this._promptNode.innerHTML;if(b){var c=j.createElement("<div>"+b+"</div>");this._outputNode.appendChild(c)}}this._prefixNode.textContent="",this._promptNode.textContent=""}},{key:"_trigger",value:function(a,b){if(this._eventHandlers[a]){var c=!0,d=!1,e=void 0;try{for(var f,g=this._eventHandlers[a][Symbol.iterator]();!(c=(f=g.next()).done);c=!0){var h=f.value;try{h(b)}catch(i){console.error(i)}}}catch(j){d=!0,e=j}finally{try{!c&&g.return&&g.return()}finally{if(d)throw e}}}}},{key:"_historyCycle",value:function(a){var b=this;Promise.all([this._historyProvider.getNextValue(a)]).then(function(a){var c=a[0];c&&(b._promptNode.textContent=c,j.cursorToEnd(b._promptNode),j.dispatchEvent(b._promptNode,"change",!0,!1))})}},{key:"_autocompleteCycle",value:function(a){var b=this;if(!this._autocompleteContext){var c=this._promptNode.textContent;c=c.replace(/\s$/," ");var d=j.getCursorPosition(this._promptNode),e=c.lastIndexOf(" ",d)+1;e=e!==-1?e:0;var f=c.indexOf(" ",e);f=f!==-1?f:c.length;var g=c.substring(e,f),h=c.substring(0,e),i=this.commandParser.parseCommand(h);this._autocompleteContext={shell:this,incompleteValue:g,precursorValue:h,parsed:i}}Promise.all([this._autocompleteProvider.getNextValue(a,this._autocompleteContext)]).then(function(a){var c=a[0];c&&(b._promptNode.textContent=b._autocompleteContext.precursorValue+c,j.cursorToEnd(b._promptNode),j.dispatchEvent(b._promptNode,"change",!0,!1))})}},{key:"_autocompleteReset",value:function(){this._autocompleteContext=null}},{key:"_fixPromptIndent",value:function(){var a=this._prefixNode.getBoundingClientRect().width,b=this._prefixNode.textContent,c=b.length-b.trim().length;if(!this._prefixNode._spaceWidth){var d=j.createElement('<span style="visibility: hidden">| |</span>');this._prefixNode.appendChild(d);var e=j.createElement('<span style="visibility: hidden">||</span>');this._prefixNode.appendChild(e),this._prefixNode._spaceWidth=d.offsetWidth-e.offsetWidth,this._prefixNode.removeChild(d),this._prefixNode.removeChild(e)}a+=c*this._prefixNode._spaceWidth,this._promptNode.style.textIndent=a+"px"}},{key:"isInitialized",get:function(){return this._isInitialized}},{key:"options",get:function(){return this._options}},{key:"promptPrefix",get:function(){return this._promptPrefix},set:function(a){this._promptPrefix=a,this._isInputInline||(this._prefixNode.textContent=a,this._fixPromptIndent())}},{key:"echo",get:function(){return this._echo},set:function(a){this._echo=a}},{key:"commandHandler",get:function(){return this._commandHandler}},{key:"commandParser",get:function(){return this._commandParser}},{key:"historyProvider",get:function(){return this._historyProvider}},{key:"autocompleteProvider",get:function(){return this._autocompleteProvider}},{key:"definitionProvider",get:function(){return this._definitionProvider}},{key:"plugins",get:function(){return Object.freeze(this._plugins)}}]),a}();c.default=x},{"./autocomplete-provider.js":3,"./cancel-token.js":4,"./command-handler.js":6,"./command-parser.js":7,"./definition-provider.js":8,"./history-provider.js":10,"./utils.js":14}],14:[function(a,b,c){"use strict";function d(a){a=a||{};for(var b=1;b<arguments.length;b++)if(arguments[b])for(var c in arguments[b])arguments[b].hasOwnProperty(c)&&(a[c]=arguments[b][c]);return a}function e(a,b,c){var d=b>=0;for(b=Math.abs(b);a.length<b;)a=d?a+c:c+a;return a}function f(a){var b=document.createElement("div");return b.appendChild(document.createTextNode(a)),b.innerHTML}function g(a){return"function"==typeof a?a():a}function h(){function a(){var a=this;this.promise=new Promise(function(b,c){a.resolve=b,a.reject=c}),this.then=this.promise.then.bind(this.promise),this.catch=this.promise.catch.bind(this.promise)}return new a}function i(a){return"object"===("undefined"==typeof HTMLElement?"undefined":o(HTMLElement))?a instanceof HTMLElement:a&&"object"===("undefined"==typeof a?"undefined":o(a))&&null!==a&&1===a.nodeType&&"string"==typeof a.nodeName}function j(a){var b=document.createElement("div");return b.innerHTML=a,b.firstChild}function k(a,b,c,d){var e=document.createEvent("HTMLEvents");e.initEvent(b,c,d),a.dispatchEvent(e)}function l(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(!a||a===document.activeElement){var b=document.createElement("input");document.body.appendChild(b),b.focus(),document.body.removeChild(b)}}function m(a){var b=document.createRange();b.selectNodeContents(a),b.collapse(!1);var c=window.getSelection();c.removeAllRanges(),c.addRange(b)}function n(a){var b=0,c=a.ownerDocument||a.document,d=c.defaultView||c.parentWindow,e=void 0;if("undefined"!=typeof d.getSelection){if(e=d.getSelection(),e.rangeCount>0){var f=d.getSelection().getRangeAt(0),g=f.cloneRange();g.selectNodeContents(a),g.setEnd(f.endContainer,f.endOffset),b=g.toString().length}}else if((e=c.selection)&&"Control"!=e.type){var h=e.createRange(),i=c.body.createTextRange();i.moveToElementText(a),i.setEndPoint("EndToEnd",h),b=i.text.length}return b}Object.defineProperty(c,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};c.extend=d,c.pad=e,c.encodeHtml=f,c.unwrap=g,c.defer=h,c.isElement=i,c.createElement=j,c.dispatchEvent=k,c.blur=l,c.cursorToEnd=m,c.getCursorPosition=n},{}]},{},[5])(5)});